B9_TANK_TYPE:NEEDS[CryoTanks,!ModularFuelTanks,!RealFuels]
{
	name = B9_LH2O
	tankMass =  0.00015
	tankCost = 0
	
	RESOURCE
	{
		name = LqdHydrogen
		unitsPerVolume = 6
	}
	
	RESOURCE
	{
		name = Oxidizer
		unitsPerVolume = 0.4
	}
}

B9_TANK_TYPE:NEEDS[CryoTanks,!ModularFuelTanks,!RealFuels]
{
	name = B9_LH2
	tankMass =  0.00005
	tankCost = 0
	
	RESOURCE
	{
		name = LqdHydrogen
		unitsPerVolume = 10
	}
}

@PART[B9_*]:HAS[~name[B9_HX_*],@MODULE[ModuleB9PartSwitch]]:NEEDS[CryoTanks,!ModularFuelTanks,!RealFuels]:AFTER[B9_Aerospace]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#baseVolume[>100]]
	{
		+SUBTYPE[*]:HAS[#tankType[LiquidFuel]]
		{
			@name ^= :LiquidFuel:LH2:
			@name ^= :LF:LH2:
			@title ^= :LiquidFuel:LH2:
			@title ^= :LF:LH2:
			
			@tankType = B9_LH2
		}
		
		+SUBTYPE[*]:HAS[#tankType[LFO]]
		{
			@name ^= :LFO:LH2O:
			@title ^= :LFO:LH2O:
			
			@tankType = B9_LH2O
		}
	}
	
	MODULE
	{
		name =  ModuleCryoTank
		FuelName = LqdHydrogen
		// in % per hr
		BoiloffRate = 0.05
	}
}

@PART[B9_Engine_SABRE_S|B9_Engine_SABRE_M]:NEEDS[CryoTanks,!RealFuels]:AFTER[B9_Aerospace]
{
	@MODULE[ModuleEngines*]:HAS[#engineID[AirBreathing]]
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		
		@PROPELLANT[IntakeAir]
		{
			@ratio /= 20
		}
		
		@atmosphereCurve
		{
			@key,*[1, ] *= 2
		}
	}
		
		
	@MODULE[ModuleEngines*]:HAS[#engineID[ClosedCycle]]
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
			@ratio = 15
		}
		
		@PROPELLANT[Oxidizer]
		{
			@ratio = 1
		}
		
		!atmosphereCurve {}
        atmosphereCurve
        {
            key = 0 460
            key = 1 350
        }
    }
}
